# DO NOT UPDATE THIS FILE MANUALLY; ANY CHANGES WILL BE OVERRIDDEN BY THE J2 DIR TEMPLATES
updatereq:
  vertices:
    
    - label: Person.Natural
      props:
        - name: Person.Natural.Full_Name
          val: ${First_Name?.trim().toUpperCase()} ${Last_Name?.trim().toUpperCase()}
          mandatoryInSearch: True
        - name: Person.Natural.Full_Name_fuzzy
          val: ${First_Name?.trim().toUpperCase()} ${Last_Name?.trim().toUpperCase()}
          mandatoryInSearch: True
        - name: Person.Natural.Type
          val: cliente
          mandatoryInSearch: True
        - name: Person.Natural.Customer_ID
          val: ${Customer_ID?.trim()}
          mandatoryInSearch: True
        - name: Person.Natural.Date_Of_Birth
          val: ${DateofBirth}
          predicate: eq
          mandatoryInSearch: True
          type: "java.util.Date"
        - name: Person.Natural.Gender
          val: ${Sex}
          mandatoryInSearch: True
    
    - label: Event.Consent
      props:
        - name: Event.Consent.Date
          val: ${new Date()}
          mandatoryInSearch: False
          type: "java.util.Date"
          excludeFromSearch: True
        - name: Event.Consent.Metadata.Create_Date
          val: ${new Date()}
          mandatoryInSearch: False
          type: "java.util.Date"
          excludeFromSearch: True
        - name: Event.Consent.Status
          val: ${'YES'.equals(Permission_to_Contact?.toUpperCase())?'Consent':'No Consent'}
          mandatoryInSearch: False
          excludeFromSearch: True
    
    - label: Object.Email_Address
      condition: ${ (Email_address != null) && ! (Email_address.isEmpty())}
      props:
        - name: Object.Email_Address.Email
          val: ${Email_address?.trim()?.toLowerCase()}
          mandatoryInSearch: True
    
    - label: Location.Address
      props:
        - name: Location.Address.Full_Address
          val: ${Address} ${Post_Code}
          mandatoryInSearch: True

  edges:
  - label: Uses_Email
    fromVertexLabel: Person.Natural
    toVertexLabel: Object.Email_Address
  - label: Has_Address
    fromVertexLabel: Person.Natural
    toVertexLabel: Location.Address
  - label: Consent
    fromVertexLabel: Person.Natural
    toVertexLabel: Event.Consent

