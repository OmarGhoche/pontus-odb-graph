rules:

  sharepoint_data_sources:
    vertices:
      - label: Object.Data_Source
        name: sharepoint
        props:
          Name: SHAREPOINT/DATA-SOURCES
#          Type: sharepoint/data-sources
#          Description: Data Sources

      - label: Object.Data_Source
        condition: "${field_Descri_x0020__x0020_o?.trim()?.length() > 0}"
        name: data_sources
        props:
          Name:
            val: "${Title}?.toUpperCase()?.trim()"
            mandatoryInSearch: true
          Description:
            val: "${field_Descri_x0020__x0020_o?.trim()?.toUpperCase()}"
            excludeFromSearch: true
          Engine:
            val: "${field_Sistema}"
            excludeFromSearch: true
          Type:
            val: "${field_Tipo_x0020_Sistema}"
            excludeFromSearch: true
          Domain:
            val: "${field_Tabela}"
            excludeFromSearch: true
          URI_Delete:
            val: "${field_URL_x0020_Prefixo_x0020_Delete}"
            excludeFromSearch: true
          URI_Update:
            val: "${field_URL_x0020_Prefixo_x0020_Update}"
            excludeFromSearch: true
          URI_Read:
            val: "${field_URL_x0020_Prefixo_x0020_Read}"
            excludeFromSearch: true

      - label: Object.Data_Policy
        props:
          Update_Frequency:
            val: "${field_Frequ_x0020_ncia_x0020_de_x0020_Atualiza_x0020__x0020_o}"
            excludeFromSearch: true
          Retention_Period:
            val: "${field_Per_x0020_odo_x0020_de_x0020_Reten_x0020__x0020_o}"
            mandatoryInSearch: true
#          Type:
#            val: "${Title}"
#            mandatoryInSearch: true

#      - label: Object.Sensitive_Data
#        props:
#          Description:
#            val: "${????????}"
#            type: "[Ljava.lang.String;"
#            mandatoryInSearch: true
#            postProcessor: "${it?.toUpperCase()?.trim()}"

      - label: Event.Ingestion
        props:
          Type:
            val: sharepoint/data-sources
            excludeFromSearch: true
          Operation:
            val: Structured Data Insertion
            excludeFromSearch: true
          Domain_b64:
            val: "${original_request?.bytes?.encodeBase64()?.toString()}"
            excludeFromSearch: true
          Metadata_Create_Date:
            val: "${new Date()}" # Date COLUMN
            excludeFromSearch: true
            type: java.util.Date
          Metadata_Update_Date:
            val: "${new Date()}"
            excludeFromSearch: true
            type: java.util.Date


      - label: Event.Group_Ingestion
        props:
          Metadata_Start_Date:
            val: "${new Date()}"
#            mandatoryInSearch: false
            excludeFromSearch: true
            type: java.util.Date
          Metadata_End_Date:
            val: "${new Date()}"
            excludeFromSearch: true
            type: java.util.Date
          Type:
            val: sharepoint/data-sources
            mandatoryInSearch: true
          Operation:
            val: Structured Data Insertion
            mandatoryInSearch: true
          Ingestion_Date:
            val: "${new java.text.SimpleDateFormat('yyyy-MM-dd').format(new Date())}"
          mandatoryInSearch: true

    edges:
#      - label: "Has_Sensitive_Data"
#        fromVertexLabel: "data_sources"
#        toVertexLabel: "Object.Sensitive_Data"

      - label: "Has_Ingestion_Event"
        fromVertexName: "sharepoint"
        toVertexLabel: "Event.Group_Ingestion"

      - label: "Has_Ingestion_Event"
        fromVertexLabel: "Event.Group_Ingestion"
        toVertexLabel: "Event.Ingestion"

      - label: "Has_Ingestion_Event"
        fromVertexLabel: "Event.Ingestion"
        toVertexName: "data_sources"

      - label: "Has_Policy"
        fromVertexName: "data_sources"
        toVertexLabel: "Object.Data_Policy"

  sharepoint_fontes_de_dados:
    vertices:
      - label: Object.Data_Source
        name: sharepoint
        props:
          Name: SHAREPOINT/FONTES-DE-DADOS
#          Type: sharepoint/fontes-de-dados
#          Description: Registros das Fontes de Dados LGPD

      - label: Object.Data_Source
        condition: "${Descri_x00e7__x00e3_o?.trim()?.length() > 0}"
        name: fontes_de_dados
        props:
          Name: "${Title?.toUpperCase()?.trim()}"
          Description:
            val: "${Descri_x00e7__x00e3_o?.trim()?.toUpperCase()}"
            excludeFromSearch: true
          Engine:
            val: "${Sistema}"
            excludeFromSearch: true
          Type:
            val: "${Tipo_x0020_Sistema}"
            excludeFromSearch: true
          Domain:
            val: "${Tabela}"
            excludeFromSearch: true
          URI_Delete:
            val: "${URL_x0020_Prefixo_x0020_Delete}"
            excludeFromSearch: true
          URI_Update:
            val: "${URL_x0020_Prefixo_x0020_Update}"
            excludeFromSearch: true
          URI_Read:
            val: "${URL_x0020_Prefixo_x0020_Read}"
            excludeFromSearch: true

      - label: Object.Sensitive_Data
        props:
          Description:
            val: "${new groovy.json.JsonBuilder(DadosPessoais)}"
            type: "[Ljava.lang.String;"
            mandatoryInSearch: true
            postProcessor: "${it?.toUpperCase()?.trim()}"
            processAll: true

      - label: Object.Data_Policy
        props:
          Update_Frequency:
            val: "${Frequ_x00ea_ncia_x0020_de_x0020_}"
            mandatoryInSearch: true
          Retention_Period:
            val: "${Pol_x00ed_tica_x0020_de_x0020_Re}"
            mandatoryInSearch: true
#          Type:
#            val: "${Title}"
#            mandatoryInSearch: true

      - label: Event.Ingestion
        props:
          Type:
            val: sharepoint/fontes-de-dados
            excludeFromSearch: true
          Operation:
            val: Structured Data Insertion
            excludeFromSearch: true
          Domain_b64:
            val: "${original_request?.bytes?.encodeBase64()?.toString()}"
            excludeFromSearch: true
          Metadata_Create_Date:
            val: "${new Date()}" # Date COLUMN
            excludeFromSearch: true
            type: java.util.Date
          Metadata_Update_Date:
            val: "${new Date()}"
            excludeFromSearch: true
            type: java.util.Date

      - label: Event.Group_Ingestion
        props:
          Metadata_Start_Date:
            val: "${new Date()}"
#            mandatoryInSearch: false
            excludeFromSearch: true
            type: java.util.Date
          Metadata_End_Date:
            val: "${new Date()}"
            excludeFromSearch: true
            type: java.util.Date
          Type:
            val: sharepoint/fontes-de-dados
            mandatoryInSearch: true
          Operation:
            val: Structured Data Insertion
            mandatoryInSearch: true
          Ingestion_Date:
            val: "${new java.text.SimpleDateFormat('yyyy-MM-dd').format(new Date())}"
            mandatoryInSearch: true

    edges:
      - label: "Has_Ingestion_Event"
        fromVertexName: "sharepoint"
        toVertexLabel: "Event.Group_Ingestion"

      - label: "Has_Ingestion_Event"
        fromVertexLabel: "Event.Group_Ingestion"
        toVertexLabel: "Event.Ingestion"

      - label: "Has_Ingestion_Event"
        fromVertexLabel: "Event.Ingestion"
        toVertexName: "fontes_de_dados"

      - label: "Has_Policy"
        fromVertexName: "fontes_de_dados"
        toVertexLabel: "Object.Data_Policy"

      - label: "Has_Sensitive_Data"
        fromVertexName: "fontes_de_dados"
        toVertexLabel: "Object.Sensitive_Data"

  sharepoint_treinamentos:
    vertices:
      - label: Event.Training
        props:
          Status:
            val: "Passed"
            excludeFromSearch: true

      - label: Object.Awareness_Campaign
        props:
          Description:
            val: "${Descri_x00e7__x00e3_o?.trim()?.toUpperCase()}"
            mandatoryInSearch: true
          #          Form_Id: "${id}"
          Start_Date:
            val: "${Realizadoem}"
            type: java.util.Date
      #          URL: "${webUrl}"

      - label: Person.Employee
        props:
          Full_Name: "${Nome0?.trim()?.toUpperCase()}"
      #          Role: "${Departamento0}"

      - label: Event.Ingestion
        props:
          Type:
            val: sharepoint/treinamentos
            excludeFromSearch: true
          Operation:
            val: Structured Data Insertion
            excludeFromSearch: true
          Domain_b64:
            val: "${original_request?.bytes?.encodeBase64()?.toString()}"
            excludeFromSearch: true
          Metadata_Create_Date:
            val: "${new Date()}" # Date COLUMN
            excludeFromSearch: true
            type: java.util.Date
          Metadata_Update_Date:
            val: "${new Date()}"
            excludeFromSearch: true
            type: java.util.Date

      - label: Event.Group_Ingestion
        props:
          Metadata_Start_Date:
            val: "${new Date()}"
            excludeFromSearch: true
            type: java.util.Date
          Metadata_End_Date:
            val: "${new Date()}"
            excludeFromSearch: true
            type: java.util.Date
          Type:
            val: sharepoint/treinamentos
            mandatoryInSearch: true
          Operation:
            val: Structured Data Insertion
            mandatoryInSearch: true
          Ingestion_Date:
            val: "${new java.text.SimpleDateFormat('yyyy-MM-dd').format(new Date())}"
            mandatoryInSearch: true


      - label: Object.Data_Source
        props:
          Name: SHAREPOINT/TREINAMENTOS
#          Type: sharepoint/treinamentos
#          Description: Registros de Treinamentos LGPD Colaboradores

    edges:
      - label: "Course_Training"
        fromVertexLabel: "Event.Training"
        toVertexLabel: "Object.Awareness_Campaign"

      - label: "Completed_By"
        fromVertexLabel: "Event.Training"
        toVertexLabel: "Person.Employee"

      - label: "Has_Ingestion_Event"
        fromVertexLabel: "Event.Ingestion"
        toVertexLabel: "Event.Training"

      - label: "Has_Ingestion_Event"
        fromVertexLabel: "Event.Group_Ingestion"
        toVertexLabel: "Event.Ingestion"

      - label: "Has_Ingestion_Event"
        toVertexLabel: "Event.Group_Ingestion"
        fromVertexLabel: "Object.Data_Source"

  sharepoint_mapeamentos:
    vertices:
      - label: Object.Data_Source
        name: sharepoint
        props:
          Name: SHAREPOINT/MAPEAMENTO-DE-PROCESSOS
#          Type: sharepoint/mapeamento-de-processos
#          Description: Mapeamento de Processo LGPD

      - label: Object.Data_Source
        name: attached_data_sources
        props:
          Name:
            val: "${new groovy.json.JsonBuilder(Local_x0020_de_x0020_Armazenamen)}"
            type: "[Lcom.pontusvision.utils.SharepointRef;"
            postProcessor: "${com.pontusvision.utils.SharepointRef.fromString(it)?.getLookupValue()?.toUpperCase()?.trim()}"
            mandatoryInSearch: true
            processAll: true



      - label: Object.Data_Policy
        props:
          Type:
            val: "${Title}"
            mandatoryInSearch: true
          Retention_Period:
            val: "${Per_x00ed_odo_x0020_de_x0020_ret}"
            mandatoryInSearch: true

      - label: Object.Data_Procedures
        props:
          ID: "${Title}"
          Name:
            val: "${Processo}"
            excludeFromSearch: true
          Type:
            val: "${Acesso_x002c__x0020_Transfer_x00}"
            excludeFromSearch: true
          Type_Of_Natural_Person:
            val: "${Categoria_x0020_dos_x0020_titula}"
            excludeFromSearch: true
          BusinessAreaResponsible:
            val: "${_x00c1_rea} - ${Respons_x00e1_velLookupId}"
            excludeFromSearch: true
          Country_Where_Stored:
            val: "${Pa_x00ed_s_x0020_onde_x0020_as_x}"
            excludeFromSearch: true
          Why_Is_It_Collected:
            val: "${Finalidade_x0020_do_x0020_proces}"
            excludeFromSearch: true
          Info_Collected:
            val: "${Dados_x0020_pessoais_x0020_utili}"
            excludeFromSearch: true
          Description:
            val: "${Fluxo_x0020_interno_x0020_dos_x0}"
            excludeFromSearch: true

      - label: Object.Sensitive_Data
        props:
          Description:
            val: "${new groovy.json.JsonBuilder(Dados_x0020_pessoais_x0020_utili)}"
            type: "[Ljava.lang.String;"
            mandatoryInSearch: true
            postProcessor: "${it?.toUpperCase()?.trim()}"
            processAll: true

      - label: Object.Lawful_Basis
        props:
          Description:
            val: "${new groovy.json.JsonBuilder(Base_x0020_legal)}"
            type: "[Ljava.lang.String;"
            mandatoryInSearch: true
            postProcessor: "${it?.toUpperCase()?.trim()}"
            processAll: true

      - label: Event.Ingestion
        props:
          Type:
            val: sharepoint/mapeamento-de-processo
            excludeFromSearch: true
          Operation:
            val: Structured Data Insertion
            excludeFromSearch: true
          Domain_b64:
            val: "${original_request?.bytes?.encodeBase64()?.toString()}"
            excludeFromSearch: true
          Metadata_Create_Date:
            val: "${new Date()}" # Date COLUMN
            excludeFromSearch: true
            type: java.util.Date
          Metadata_Update_Date:
            val: "${new Date()}"
            excludeFromSearch: true
            type: java.util.Date

      - label: Event.Group_Ingestion
        props:
          Metadata_Start_Date:
            val: "${new Date()}"
            excludeFromSearch: true
            type: java.util.Date
          Metadata_End_Date:
            val: "${new Date()}"
            excludeFromSearch: true
            type: java.util.Date
          Type:
            val: sharepoint/mapeamento-de-processo
            mandatoryInSearch: true
          Operation:
            val: Structured Data Insertion
            mandatoryInSearch: true
          Ingestion_Date:
            val: "${new java.text.SimpleDateFormat('yyyy-MM-dd').format(new Date())}"
            mandatoryInSearch: true
    edges:
      - label: "Has_Ingestion_Event"
        fromVertexName: "sharepoint"
        toVertexLabel: "Event.Group_Ingestion"

      - label: "Has_Ingestion_Event"
        fromVertexLabel: "Event.Group_Ingestion"
        toVertexLabel: "Event.Ingestion"

      - label: "Has_Ingestion_Event"
        fromVertexLabel: "Event.Ingestion"
        toVertexLabel: "Object.Data_Procedures"

      - label: "Has_Sensitive_Data"
        fromVertexLabel: "Object.Data_Procedures"
        toVertexLabel: "Object.Sensitive_Data"

      - label: "Has_Lawful_Basis_On"
        fromVertexLabel: "Object.Data_Procedures"
        toVertexLabel: "Object.Lawful_Basis"

      - label: "Has_Policy"
        fromVertexLabel: "Object.Data_Procedures"
        toVertexLabel: "Object.Data_Policy"

      - label: "Has_Data_Source"
        fromVertexLabel: "Object.Data_Procedures"
        toVertexName: "attached_data_sources"


  sharepoint_ropa:
    vertices:
      - label: Object.Data_Source
        name: sharepoint
        props:
          Name: SHAREPOINT/ROPA
#          Type: sharepoint/ropa
#          Description: Reg of Procs and Activ

      - label: Object.Data_Source
        name: attached_data_sources
        props:
          Name:
            val: "${new groovy.json.JsonBuilder(Data_x0020_Source)}"
            type: "[Lcom.pontusvision.utils.SharepointRef;"
            postProcessor: "${com.pontusvision.utils.SharepointRef.fromString(it)?.getLookupValue()?.toUpperCase()?.trim()}"
            mandatoryInSearch: true
            processAll: true



      - label: Object.Data_Policy
        props:
          Type:
            val: "${Title}"
            mandatoryInSearch: true
          Retention_Period:
            val: "${field_retention_x0020_period}"
            mandatoryInSearch: true

      - label: Object.Data_Procedures
        props:
          ID: "${Title}"
          Name:
            val: "${field_Process}"
            excludeFromSearch: true
          Description:
            val: "${field_Purpose_x0020_of_x0020_the_x0020_process}"
            excludeFromSearch: true
          Type:
            val: "${field_Access_x0020__x0020_Transfer_x0020_to_x0020_AND_x0020_OR_x0020_Receipt_x0020_of_x0020_third_x0020_parties}"
            excludeFromSearch: true
          Type_Of_Natural_Person:
            val: "${field_Data_x0020_subject_x0020_category}"
            excludeFromSearch: true
          BusinessAreaResponsible:
            val: "${field_Area} - ${field_Responsible}"
            excludeFromSearch: true
          Country_Where_Stored:
            val: "${field_Country_x0020_where_x0020_people_x0020_are_x0020_located}"
            excludeFromSearch: true
          Why_Is_It_Collected:
            val: "${field_Purpose_x0020_of_x0020_the_x0020_process}"
            excludeFromSearch: true
          Info_Collected:
            val: "${field_Personal_x0020_data_x0020_used}"
            excludeFromSearch: true

      - label: Object.Sensitive_Data
        props:
          Description:
            val: "${new groovy.json.JsonBuilder(field_Personal_x0020_data_x0020_used)}"
            type: "[Ljava.lang.String;"
            mandatoryInSearch: true
            postProcessor: "${it?.toUpperCase()?.trim()}"
            processAll: true

      - label: Object.Lawful_Basis
        props:
          Description:
            val: "${new groovy.json.JsonBuilder(field_Lawful_x0020_basis)}"
            type: "[Ljava.lang.String;"
            mandatoryInSearch: true
            postProcessor: "${it?.toUpperCase()?.trim()}"
            processAll: true

      - label: Event.Ingestion
        props:
          Type:
            val: sharepoint/ropa
            excludeFromSearch: true
          Operation:
            val: Structured Data Insertion
            excludeFromSearch: true
          Domain_b64:
            val: "${original_request?.bytes?.encodeBase64()?.toString()}"
            excludeFromSearch: true
          Metadata_Create_Date:
            val: "${new Date()}" # Date COLUMN
            excludeFromSearch: true
            type: java.util.Date
          Metadata_Update_Date:
            val: "${new Date()}"
            excludeFromSearch: true
            type: java.util.Date

      - label: Event.Group_Ingestion
        props:
          Metadata_Start_Date:
            val: "${new Date()}"
            excludeFromSearch: true
            type: java.util.Date
          Metadata_End_Date:
            val: "${new Date()}"
            excludeFromSearch: true
            type: java.util.Date
          Type:
            val: sharepoint/ropa
            mandatoryInSearch: true
          Operation:
            val: Structured Data Insertion
            mandatoryInSearch: true
          Ingestion_Date:
            val: "${new java.text.SimpleDateFormat('yyyy-MM-dd').format(new Date())}"
            mandatoryInSearch: true
    edges:
      - label: "Has_Ingestion_Event"
        fromVertexName: "sharepoint"
        toVertexLabel: "Event.Group_Ingestion"

      - label: "Has_Ingestion_Event"
        fromVertexLabel: "Event.Group_Ingestion"
        toVertexLabel: "Event.Ingestion"

      - label: "Has_Ingestion_Event"
        fromVertexLabel: "Event.Ingestion"
        toVertexLabel: "Object.Data_Procedures"

      - label: "Has_Sensitive_Data"
        fromVertexLabel: "Object.Data_Procedures"
        toVertexLabel: "Object.Sensitive_Data"

      - label: "Has_Lawful_Basis_On"
        fromVertexLabel: "Object.Data_Procedures"
        toVertexLabel: "Object.Lawful_Basis"

      - label: "Has_Policy"
        fromVertexLabel: "Object.Data_Procedures"
        toVertexLabel: "Object.Data_Policy"

      - label: "Has_Data_Source"
        fromVertexLabel: "Object.Data_Procedures"
        toVertexName: "attached_data_sources"


  sharepoint_risk:
    vertices:
      - label: Object.Data_Source
        name: sharepoint
        props:
          Name: SHAREPOINT/RISK
#          Type: sharepoint/risk
#          Description:  Data Source Risk

      - label: Object.Data_Source
        name: attached_data_sources
        props:
          Name:
            val: "${new groovy.json.JsonBuilder(Data_x0020_Sources)}"
            type: "[Lcom.pontusvision.utils.SharepointRef;"
            postProcessor: "${com.pontusvision.utils.SharepointRef.fromString(it)?.getLookupValue()?.trim()?.toUpperCase()}"
            mandatoryInSearch: true
            processAll: true

      - label: Object.Risk_Data_Source
        props:
          Risk_Id: "${Title?.trim()?.toUpperCase()}"
          Description:
            val: "${field_Description}"
            excludeFromSearch: true
          Probability:
            val: "${field_Probability}"
            excludeFromSearch: true

          Impact:
            val: "${field_Impact}"
            excludeFromSearch: true

          Residual_Probability:
            val: "${field_Residual_x0020_Probability}"
            excludeFromSearch: true


          Residual_Impact:
            val: "${field_Residual_x0020_Impact}"
            excludeFromSearch: true


      - label: Object.Risk_Mitigation_Data_Source
        props:
          Mitigation_Id:
            val: "${new groovy.json.JsonBuilder(Risk_x0020_Mitigations)}"
            type: "[Lcom.pontusvision.utils.SharepointRef;"
            postProcessor: "${com.pontusvision.utils.SharepointRef.fromString(it)?.getLookupValue()?.trim()?.toUpperCase()}"
            mandatoryInSearch: true
            processAll: true



      - label: Event.Ingestion
        props:
          Type:
            val: sharepoint/risk
            excludeFromSearch: true
          Operation:
            val: Structured Data Insertion
            excludeFromSearch: true
          Domain_b64:
            val: "${original_request?.bytes?.encodeBase64()?.toString()}"
            excludeFromSearch: true
          Metadata_Create_Date:
            val: "${new Date()}" # Date COLUMN
            excludeFromSearch: true
            type: java.util.Date
          Metadata_Update_Date:
            val: "${new Date()}"
            excludeFromSearch: true
            type: java.util.Date

      - label: Event.Group_Ingestion
        props:
          Metadata_Start_Date:
            val: "${new Date()}"
            excludeFromSearch: true
            type: java.util.Date
          Metadata_End_Date:
            val: "${new Date()}"
            excludeFromSearch: true
            type: java.util.Date
          Type:
            val: sharepoint/risk
            mandatoryInSearch: true
          Operation:
            val: Structured Data Insertion
            mandatoryInSearch: true
          Ingestion_Date:
            val: "${new java.text.SimpleDateFormat('yyyy-MM-dd').format(new Date())}"
            mandatoryInSearch: true
    edges:
      - label: "Has_Ingestion_Event"
        fromVertexName: "sharepoint"
        toVertexLabel: "Event.Group_Ingestion"

      - label: "Has_Ingestion_Event"
        fromVertexLabel: "Event.Group_Ingestion"
        toVertexLabel: "Event.Ingestion"

      - label: "Has_Ingestion_Event"
        fromVertexLabel: "Event.Ingestion"
        toVertexLabel: "Object.Risk_Data_Source"

      - label: "Has_Risk"
        fromVertexName: "attached_data_sources"
        toVertexLabel: "Object.Risk_Data_Source"

      - label: "Mitigates_Risk"
        fromVertexLabel: "Object.Risk_Mitigation_Data_Source"
        toVertexLabel: "Object.Risk_Data_Source"




  sharepoint_risk_mitigation:
    vertices:
      - label: Object.Data_Source
        name: sharepoint
        props:
          Name: SHAREPOINT/RISK-MITIGATIONS
#          Type: sharepoint/risk-mitigations
#          Description:  Risk Mitigations


      - label: Object.Risk_Mitigation_Data_Source
        props:
          Mitigation_Id: "${Title?.trim()?.toUpperCase()}"
          Description:
            val: "${field_Description}"
            excludeFromSearch: true

      - label: Event.Ingestion
        props:
          Type:
            val: risk-mitigations
            excludeFromSearch: true
          Operation:
            val: Structured Data Insertion
            excludeFromSearch: true
          Domain_b64:
            val: "${original_request?.bytes?.encodeBase64()?.toString()}"
            excludeFromSearch: true
          Metadata_Create_Date:
            val: "${new Date()}" # Date COLUMN
            excludeFromSearch: true
            type: java.util.Date
          Metadata_Update_Date:
            val: "${new Date()}"
            excludeFromSearch: true
            type: java.util.Date

      - label: Event.Group_Ingestion
        props:
          Metadata_Start_Date:
            val: "${new Date()}"
            excludeFromSearch: true
            type: java.util.Date
          Metadata_End_Date:
            val: "${new Date()}"
            excludeFromSearch: true
            type: java.util.Date
          Type:
            val: sharepoint/risk-mitigations
            mandatoryInSearch: true
          Operation:
            val: Structured Data Insertion
            mandatoryInSearch: true
          Ingestion_Date:
            val: "${new java.text.SimpleDateFormat('yyyy-MM-dd').format(new Date())}"
            mandatoryInSearch: true
    edges:
      - label: "Has_Ingestion_Event"
        fromVertexName: "sharepoint"
        toVertexLabel: "Event.Group_Ingestion"

      - label: "Has_Ingestion_Event"
        fromVertexLabel: "Event.Group_Ingestion"
        toVertexLabel: "Event.Ingestion"

      - label: "Has_Ingestion_Event"
        fromVertexLabel: "Event.Ingestion"
        toVertexLabel: "Object.Risk_Mitigation_Data_Source"

